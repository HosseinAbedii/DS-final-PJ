FROM bitnami/spark:3.5.3

USER root
WORKDIR /app

# Install all required dependencies
RUN pip install kafka-python pyspark==3.5.3 requests numpy psutil pandas redis flask flask-cors websockets

# Create necessary directories and set permissions
RUN mkdir -p /app/logs && \
    mkdir -p /root/.ivy2 && \
    chmod -R 777 /app/logs && \
    chmod -R 777 /root/.ivy2

# Don't set CMD here as it will be overridden by deployment command
